<div class="padding-zero" style="height:100%;">
    <div class="social-plugin social-thread" style="height: 100%;">

        <div ng-if="Thread.allowFollowLeaveGroup"
        sticky-navbar scroll-container=".social-plugin.social-thread .post-section"
        class="head-btn text-center backgroundColorTheme">
            <p class="text-primary follow-btn" ng-click="Thread.followUnfollow()">
                <button class="btn btn-danger-outlined ng-binding" id="followBtn">
                    {{Thread.followingStatus? Thread.SocialItems.languages.unfollowPost: Thread.SocialItems.languages.followPost }}
                </button>
            </p>
        </div>
        <div ng-class="{'has-comment-box':Thread.SocialItems.userDetails.userId == null || Thread.allowCreateThread,'has-group-header' : Thread.allowFollowLeaveGroup}"
            class="post-section backgroundColorTheme">
            <div class="social-item" ng-class="{'has-comments': Thread.post.commentsCount > 1, 'first-post':Thread.allowFollowLeaveGroup}">
                <div class="head flex flex-space-between">
                    <div class="social-profile-photo pointer"
                        ng-click="Thread.SocialItems.userDetails.userId !== Thread.post.userId && Thread.openBottomDrawer(Thread.post)">
                        <div class="media-holder pull-left">
                            <img ng-if="Thread.post.userId && Thread.post.userDetails.imageUrl"
                                load-image="1x1" data-final-src="{{Thread.post.userDetails.imageUrl}}" crop-width="40"
                                crop-height="40" crop-type="crop">
                            <img ng-if="!(Thread.post.userId && Thread.post.userDetails.imageUrl)"
                                load-image="1x1" data-final-src="../../../styles/media/avatar-placeholder.png"
                                data-img-type="local" crop-width="40" crop-height="40" crop-type="default">
                        </div>
                        <div class="social-copy padding-half-rem padding-top-zero padding-bottom-zero">
                            <p class="text-primary ellipsis">
                                <a>
                                    {{Thread.getDisplayName(Thread.post.userId, Thread.post.userDetails)}}</a>
                            </p>
                            <div ng-if="Thread.post.createdOn">
                                <p class="time-ago opacity-seventy">
                                    {{Thread.getDuration(Thread.post.createdOn) | convertTimeFormat}}</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="post-text copy" style="word-wrap: break-word">
                    <p class="margin-zero body-text-theme" ng-bind-html="Thread.util.injectAnchors(Thread.post.text) | newLine"></p><p></p>
                </div>
                <div class="post-media-container clearfix" ng-if="Thread.post.imageUrl.length > 0 || Thread.post.videos.length > 0">
                    <div class="post-media-wrapper text-center" style="max-height: none !important;">
                        <div ng-repeat="image in Thread.post.imageUrl track by $index" class="post-images-container">
                            <img ng-src="{{Thread.util.resizeImage(image)}}" data-alt="Post image" ng-click="Thread.SocialItems.previewImage($event, $index, Thread.post.imageUrl)">
                        </div>
                        <div ng-repeat="video in Thread.post.videos track by $index" class="post-videos-container">
                            <video controls width="100%" playsinline>
                                <source ng-src="{{video}}" type="video/mp4">
                            </video>
                        </div>
                    </div>
                </div>
                <div class="footer">
                    <div class="status-footer">
                        <div class="footer-left">
                            <a class="likes social-icon ng-cloak" ng-click="Thread.likeThread(Thread.post, 'thread')">
                                <i class="material-icons-outlined" aria-hidden="true">{{!isItemLiked(Thread.post, Thread.SocialItems.userDetails.userId)?"favorite_border":"favorite"}}</i>
                                <span class="iconsTheme iconsFont"
                                    ng-class="{active: isItemLiked(Thread.post, Thread.SocialItems.userDetails.userId)}">{{Thread.post.likes.length}}</span>
                            </a>
                            <a class="social-icon comments ng-cloak" ng-if="Thread.allowCreateThread" ng-click="Thread.openCommentSection()">
                                <svg class="comment-bubble-icon" viewBox="0 0 100 100" aria-hidden="true">
                                    <path d="M50,10 C25,10 5,27 5,48 C5,58 9,67 16,74 L10,90 L28,82 C35,85 42,87 50,87 C75,87 95,70 95,48 C95,27 75,10 50,10 Z" fill="white" stroke="currentColor" stroke-width="3"/>
                                </svg>
                                <span class="iconsTheme iconsFont">{{Thread.post.commentsCount || 0}}</span>
                            </a>
                        </div>
                        <div class="footer-right">
                            <a class="social-icon ng-cloak" ng-click="Thread.sharePost(Thread.post)">
                                <img src="assets/img/send(2).png" class="share-icon-img" alt="Share">
                            </a>
                            <a class="social-icon ng-cloak" ng-click="Thread.openBottomDrawer(Thread.post)">
                                <span class="material-icons-outlined">more_vert</span>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="comments-list" ng-if="Thread.processedComments">
                    <div class="social-comment" ng-repeat="comment in Thread.post.comments">
                        <div class="thread-dot head pointer"
                             ng-click="comment.userId !== Thread.SocialItems.userDetails.userId && Thread.showMoreOptionsComment(comment)">
                            <div class="media-holder pull-left">
                                <img ng-if="comment.userDetails.imageUrl && !Thread.isBlockedUser(comment.userId)"
                                    load-image="1x1" data-final-src="{{comment.userDetails.imageUrl}}" crop-width="40"
                                    crop-height="40" crop-type="crop">
                                <img ng-if="!(comment.userDetails.imageUrl) || Thread.isBlockedUser(comment.userId)"
                                    load-image="1x1" data-final-src="../../../styles/media/avatar-placeholder.png"
                                    data-img-type="local" crop-width="40" crop-height="40" crop-type="default">
                            </div>
                        </div>
                        <div class="comment-content ellipsis" style="max-width: 85%">
                            <div class="social-profile-photo pointer"
                            ng-click="comment.userId !== Thread.SocialItems.userDetails.userId && Thread.showMoreOptionsComment(comment)">
                                <div class="social-copy">
                                    <a class="social-name text-primary">{{Thread.getDisplayName(comment.userId, comment.userDetails)}}</a>
                                    <div ng-if="comment.createdOn">
                                        <p class="time-ago opacity-seventy">
                                            {{Thread.getDuration(comment.createdOn) | convertTimeFormat}}</p>
                                    </div>
                                </div>
                            </div>
                            <div class="post-text copy">
                                <p class="margin-zero body-text-theme" ng-if="!comment.deletedOn"
                                    ng-bind-html="Thread.util.injectAnchors(comment.comment)|newLine"></p>
                                    <p class="margin-zero" ng-if="comment.deletedOn">
                                        {{Thread.SocialItems.languages.messageDeleted ? Thread.SocialItems.languages.messageDeleted  : "This message was deleted."}}
                                    </p>
                            </div>
                            <div class="post-media-container ellipsis" ng-if="comment.imageUrl.length > 0 || comment.videos.length > 0">
                                <div class="post-media-wrapper text-center" style="max-height: none !important;">
                                    <img ng-repeat="image in comment.imageUrl track by $index" ng-src="{{Thread.util.resizeImage(image)}}" data-alt="Post image" ng-click="Thread.SocialItems.previewImage($event, $index, comment.imageUrl)">
                                    <div ng-repeat="video in comment.videos track by $index" class="post-videos-container">
                                        <video controls width="100%" playsinline>
                                            <source ng-src="{{video}}" type="video/mp4">
                                        </video>
                                    </div>
                                </div>
                            </div>
                            <div ng-show="comment.threadId && !comment.deletedOn" class="status-footer">
                                <a class="social-icon likes" ng-click="!Thread.isBlockedUser(comment.userId) && Thread.likeComment(comment, 'comment')">
                                    <i class="material-icons-outlined" ng-class="{notActive: !isItemLiked(comment, Thread.SocialItems.userDetails.userId) }" aria-hidden="true">{{!isItemLiked(comment, Thread.SocialItems.userDetails.userId)?"thumb_up_off_alt":"thumb_up_alt"}}</i>
                                    <span class="iconsTheme iconsFont"
                                        ng-class="{active: isItemLiked(comment, Thread.SocialItems.userDetails.userId)}">{{comment.likes.length}}</span>
                                </a>

                            </div>
                        </div>
                        <a class="social-icon margin-one-rem margin-top-zero margin-bottom-zero"
                        ng-hide = "comment.userId != Thread.SocialItems.userDetails.userId || !comment.commentId"
                        ng-click="Thread.showMoreOptionsComment(comment)" style="height: 2rem; margin-top: 0.75rem;">
                        <span class="material-icons-outlined">more_horiz</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div ng-show="!Thread.loaded">
        <div class="social-item margin-top-half-rem" ng-class="{'first-post': Thread.allowFollowLeaveGroup}"></div>
        <div class="comments-list">
            <div class="social-item-comment"></div>
            <div class="social-item-comment"></div>
            <div class="social-item-comment"></div>
            <div class="social-item-comment"></div>
            <div class="social-item-comment"></div>
            <div class="social-item-comment"></div>
            <div class="social-item-comment"></div>
            <div class="social-item-comment"></div>
            <div class="social-item-comment"></div>
            <div class="social-item-comment"></div>
            <div class="social-item-comment"></div>
            <div class="social-item-comment"></div>
        </div>
    </div>
</div>

<div class="custom-post-dialog" ng-show="Thread.showCustomPostDialog">
    <div class="custom-post-overlay" ng-click="Thread.closeCustomPostDialog()"></div>
    <div class="custom-post-content">
        <div class="custom-post-input-section">
            <input type="text"
                   class="custom-post-input"
                   placeholder="Add message"
                   ng-model="Thread.customPostText"
                   ng-keypress="Thread.handlePostKeyPress($event)">
        </div>
        <div class="custom-post-actions">
            <div class="custom-post-send" ng-click="Thread.submitCustomPost()">
                <img src="assets/img/send(2).png" class="send-icon-img" alt="Send">
            </div>
        </div>
    </div>
</div>
